# < 롯데백화점 성별예측 AI 경진대회 >
<br>
    
## 0. 프로젝트 개요(머신러닝 파트에 해당)
    
롯데백화점 데이터로 남/녀를 구분하는 분류분석을 시행하려 한다. 현 데이터는 남성보다 여성이 더 많은 불균형 데이터이다. 따라서 성별에 따른 특징이 보이는 피쳐를 생성하고자 노력하였다. 피쳐는 크게 5가지 관점(가격, 시간, 장소, 제품, 기타)으로 고객을 파악 및 구분하고자 하였다. 이러한 피쳐들의 유용성을 판단하기 위해서 countplot과 kdeplot을 통한 탐색적 데이터분석을 진행하였다. EDA이후 상관관계가 높은 피쳐들을 확인하였고 이를 일부 제거하여 모든 피쳐끼리 상관관계가 0.7를 넘지않는 최종 피쳐를 생성하였다. 모델링에는 데이터불균형을 해소시키기 위해서 모든 모델에 기본적으로 Stratified KFold을 적용하였다. 튜닝은 랜덤서치와 베이지안 최적화를 이용하여 모델마다 가장 최적화된 파라미터를 찾고자 하였으며 훈련데이터를 모두 활용하고자 train_test_split없이 cross_val_score를 이용하였다. 이렇게 튜닝된 모델로 해본 앙상블의 종류는 3가지로, SoftVoting, Stacking, 그리고 tree기반 모델과 boosting기반 모델의 bestModel을 뽑아서 Seed(3)와 Stratified KFold(4)로 12번의 교차검정을 거친 후 예측값을 앙상블해보았다. 이러한 앙상블 과정 중 새롭게 시도해볼 수 있었던 점은 스태킹에 있어서 메타모델을 베이지안최적화를 통해서 튜닝해보았다는 것과 교차검정을 통한 앙상블이었다. 교차검정을 통한 앙상블은 랜덤서치와 베이지안 최적화를 통해서 튜닝된 20여개의 모델중에서 가장 점수가 잘나온 트리기반의 모델과 부스팅 기반의 모델을 각각 12번의 교차검정을 통해서 predict_proba의 평균을 내었고 이후 트리기반prediction : 부스팅기반prediction을 1 : 2의 비율로 앙상블 하였다. 각 모델마다의 진짜 성능은 제출한 submission의 roc_auc점수를 통해서 알 수 있을 것이다. 그래서 train에 대해서 나온 점수보다는 새롭게 시도하여 본 베이지안 최적화를 통한 메타모델의 점수가 궁금하여 해당 submission을 제출하였다.
    
    
## 1.배경&목적
 - 롯데백화점 고객의 구매데이터를 분석하여 고객의 성별을 예측하는 분류분석을 시행
<br>
    
## 2.주최/주관  
 - 주최&주관: 국민대학교 조윤호 교수 머신러닝 수업
<br>

## 3. 참가 대상  
 - 국민대학교 빅데이터경영통계전공 3~4학년 학생, 45명
<br>

## 4. 대회 기간
 - 2020년 1학기
<br>

## 5. 성과
 - 머신러닝 성별예측 개인성능 1등
 - W2V 성별예측 개인성능 1등
 - Kaggle Competition 팀 대결 총 16팀 중 4등

<br>

ps. 딥러닝 파트는 대체로 교수님의 코드를 그대로 응용하였어서 올리지 않음
